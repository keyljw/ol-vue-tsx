<template>
  <o-map v-loading="loading" height="400px" :center="[120.171465, 30.250236]" :zoom="11">
    <o-select>
      <o-select-item type="pointerMove" :checkStyle="checkStyle" />
      <o-select-item type="singleClick" @select="onClick" />
      <o-layer :ol-style="style">
        <o-polygon
          v-for="(item, index) in coordinatesList"
          :key="index"
          :id="index"
          :data="item"
          :coordinates="item.coordinates"
        ></o-polygon>
      </o-layer>
    </o-select>
    <o-html :position="position" positioning="buttom-right" :offset="[0, 0]" :autoPan="false">
      <el-card class="box-card">
        <template #header>
          <div class="card-header">
            <span>Card name</span>
          </div>
        </template>
        <div v-for="o in 4" :key="o" class="text item">{{ 'List item ' + o }}</div>
      </el-card>
    </o-html>
  </o-map>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import type Polygon from 'ol/geom/Polygon'
import type { Feature } from 'ol'
import { onMounted } from 'vue'
let checkId = ref(0)
let loading = ref(true)
let checkStyle = (feature: Feature<Polygon>) => style(feature, 0, 'rgba(255, 255, 255, 0.8)')
let style = (feature: Feature<Polygon>, _c: number, color = 'rgba(255, 255, 255, 0.2)') => {
  let data = feature.get('data')
  return {
    fill: { color },
    stroke: { color: '#409eff', width: 5 },
    text: {
      font: 'bold  12px D-DIN',
      textAlign: 'center',
      fill: { color: '#FE726B' },
      text: data?.properties?.name
    }
  }
}
let position = ref([])

let onClick = (selData: any) => {
  let { selected, mapBrowserEvent } = selData
  if (selected.length) {
    position.value = mapBrowserEvent.coordinate
  } else {
    position.value = []
  }
}

let coordinatesList = ref()

onMounted(() => {
  setTimeout(() => {
    loading.value = false
    coordinatesList.value = [
      {
        properties: {
          name: '上城区',
          center: [120.171465, 30.250236]
        },
        coordinates: [
          [
            [120.293461, 30.315084],
            [120.291631, 30.315331],
            [120.291964, 30.317814],
            [120.275562, 30.319857],
            [120.272591, 30.320516],
            [120.276251, 30.3233],
            [120.281885, 30.328499],
            [120.279318, 30.336686],
            [120.277868, 30.337948],
            [120.266553, 30.331338],
            [120.268051, 30.328663],
            [120.264437, 30.326578],
            [120.258471, 30.334355],
            [120.260872, 30.335452],
            [120.261466, 30.337523],
            [120.252552, 30.337043],
            [120.248012, 30.338853],
            [120.246015, 30.342871],
            [120.243543, 30.344174],
            [120.236056, 30.339786],
            [120.234772, 30.340691],
            [120.239883, 30.344997],
            [120.242236, 30.348261],
            [120.243947, 30.354116],
            [120.243567, 30.358188],
            [120.244233, 30.359902],
            [120.247109, 30.362343],
            [120.2468, 30.363947],
            [120.239978, 30.372146],
            [120.23482, 30.376683],
            [120.23791, 30.380028],
            [120.240334, 30.387622],
            [120.237577, 30.390062],
            [120.232395, 30.392529],
            [120.228592, 30.393544],
            [120.221294, 30.387156],
            [120.210502, 30.37911],
            [120.208815, 30.376478],
            [120.208957, 30.374243],
            [120.211121, 30.37035],
            [120.210098, 30.36987],
            [120.215209, 30.364029],
            [120.215328, 30.361452],
            [120.213569, 30.359176],
            [120.210764, 30.357585],
            [120.204251, 30.352662],
            [120.199853, 30.35099],
            [120.201042, 30.348124],
            [120.20437, 30.345738],
            [120.212285, 30.34534],
            [120.212095, 30.334149],
            [120.211168, 30.332119],
            [120.207935, 30.332298],
            [120.207531, 30.330501],
            [120.204227, 30.330625],
            [120.202349, 30.326236],
            [120.204417, 30.325961],
            [120.202421, 30.322176],
            [120.197833, 30.322244],
            [120.196906, 30.320118],
            [120.204322, 30.320488],
            [120.207198, 30.320118],
            [120.200186, 30.312148],
            [120.197952, 30.314329],
            [120.194838, 30.312093],
            [120.190607, 30.312642],
            [120.18987, 30.308856],
            [120.188301, 30.30876],
            [120.188253, 30.304507],
            [120.193007, 30.30474],
            [120.190892, 30.300295],
            [120.186494, 30.29714],
            [120.183975, 30.285367],
            [120.184926, 30.28121],
            [120.18899, 30.274321],
            [120.188182, 30.270849],
            [120.188658, 30.267294],
            [120.188063, 30.257783],
            [120.171804, 30.258003],
            [120.164079, 30.25836],
            [120.156948, 30.258058],
            [120.15923, 30.256397],
            [120.16251, 30.251565],
            [120.159848, 30.249493],
            [120.15797, 30.24672],
            [120.160442, 30.246843],
            [120.154666, 30.241119],
            [120.154381, 30.23442],
            [120.15923, 30.231578],
            [120.160347, 30.227486],
            [120.150173, 30.212849],
            [120.147368, 30.210268],
            [120.145253, 30.209581],
            [120.139405, 30.210474],
            [120.138431, 30.207947],
            [120.141069, 30.206464],
            [120.141545, 30.204061],
            [120.137551, 30.201012],
            [120.1371, 30.1981],
            [120.138169, 30.19512],
            [120.140166, 30.19284],
            [120.177628, 30.205626],
            [120.182858, 30.207933],
            [120.196573, 30.216571],
            [120.211287, 30.228722],
            [120.221057, 30.23766],
            [120.241665, 30.26514],
            [120.248036, 30.272468],
            [120.252838, 30.276091],
            [120.269786, 30.284105],
            [120.270594, 30.284722],
            [120.278961, 30.286822],
            [120.288136, 30.288235],
            [120.29377, 30.289566],
            [120.295196, 30.300981],
            [120.295505, 30.306291],
            [120.293461, 30.315084]
          ]
        ]
      },
      {
        properties: {
          name: '拱墅区',
          center: [120.150053, 30.314697]
        },
        coordinates: [
          [
            [120.085779, 30.331187],
            [120.088489, 30.330529],
            [120.092007, 30.326071],
            [120.095597, 30.325481],
            [120.102038, 30.312697],
            [120.102823, 30.304672],
            [120.102062, 30.300117],
            [120.105533, 30.300227],
            [120.106507, 30.292269],
            [120.109241, 30.291995],
            [120.118012, 30.29264],
            [120.128709, 30.294286],
            [120.132512, 30.292791],
            [120.135198, 30.292626],
            [120.141188, 30.293902],
            [120.144112, 30.291144],
            [120.146132, 30.286589],
            [120.149294, 30.28206],
            [120.150934, 30.278506],
            [120.153763, 30.275734],
            [120.158469, 30.259142],
            [120.156472, 30.260295],
            [120.156948, 30.258058],
            [120.164079, 30.25836],
            [120.171804, 30.258003],
            [120.188063, 30.257783],
            [120.188658, 30.267294],
            [120.188182, 30.270849],
            [120.18899, 30.274321],
            [120.184926, 30.28121],
            [120.183975, 30.285367],
            [120.186494, 30.29714],
            [120.190892, 30.300295],
            [120.193007, 30.30474],
            [120.188253, 30.304507],
            [120.188301, 30.30876],
            [120.18987, 30.308856],
            [120.190607, 30.312642],
            [120.194838, 30.312093],
            [120.197952, 30.314329],
            [120.200186, 30.312148],
            [120.207198, 30.320118],
            [120.204322, 30.320488],
            [120.196906, 30.320118],
            [120.197833, 30.322244],
            [120.202421, 30.322176],
            [120.204417, 30.325961],
            [120.202349, 30.326236],
            [120.204227, 30.330625],
            [120.207531, 30.330501],
            [120.207935, 30.332298],
            [120.211168, 30.332119],
            [120.212095, 30.334149],
            [120.212285, 30.34534],
            [120.20437, 30.345738],
            [120.201042, 30.348124],
            [120.199853, 30.35099],
            [120.204251, 30.352662],
            [120.210764, 30.357585],
            [120.213569, 30.359176],
            [120.215328, 30.361452],
            [120.215209, 30.364029],
            [120.210098, 30.36987],
            [120.211121, 30.37035],
            [120.208957, 30.374243],
            [120.208815, 30.376478],
            [120.210502, 30.37911],
            [120.221294, 30.387156],
            [120.216778, 30.387896],
            [120.212998, 30.39109],
            [120.209908, 30.392557],
            [120.19838, 30.394174],
            [120.192485, 30.396148],
            [120.186162, 30.38802],
            [120.183832, 30.381618],
            [120.177699, 30.376807],
            [120.174348, 30.371954],
            [120.173444, 30.374942],
            [120.171828, 30.37582],
            [120.168595, 30.3746],
            [120.171044, 30.37401],
            [120.170782, 30.372475],
            [120.167882, 30.371035],
            [120.159016, 30.372543],
            [120.159254, 30.375559],
            [120.153002, 30.375861],
            [120.152741, 30.380686],
            [120.149175, 30.38033],
            [120.146204, 30.377835],
            [120.146132, 30.375683],
            [120.140736, 30.376176],
            [120.138526, 30.378095],
            [120.139073, 30.380316],
            [120.1342, 30.380947],
            [120.130943, 30.383222],
            [120.129327, 30.382633],
            [120.128994, 30.379795],
            [120.129279, 30.371666],
            [120.130182, 30.362754],
            [120.131537, 30.357708],
            [120.133843, 30.354568],
            [120.136957, 30.343379],
            [120.129446, 30.341144],
            [120.129446, 30.342515],
            [120.124953, 30.339498],
            [120.123764, 30.33644],
            [120.123265, 30.339224],
            [120.121387, 30.337948],
            [120.114137, 30.337262],
            [120.111737, 30.33969],
            [120.108409, 30.339978],
            [120.1081, 30.342803],
            [120.106127, 30.343283],
            [120.103702, 30.3415],
            [120.097641, 30.340581],
            [120.099019, 30.338305],
            [120.096405, 30.335685],
            [120.091746, 30.333395],
            [120.090011, 30.334931],
            [120.085779, 30.331187]
          ]
        ]
      },
      {
        type: 'Feature',
        properties: {
          name: '西湖区',
          center: [120.147376, 30.272934]
        },
        coordinates: [
          [
            [119.996332, 30.181536],
            [119.998994, 30.182305],
            [120.005459, 30.182346],
            [120.011449, 30.181852],
            [120.013494, 30.181042],
            [120.016156, 30.177072],
            [120.014397, 30.173816],
            [120.017772, 30.168417],
            [120.018913, 30.165202],
            [120.018438, 30.162963],
            [120.014825, 30.15891],
            [120.017178, 30.153167],
            [120.016417, 30.148935],
            [120.011663, 30.142779],
            [120.008858, 30.136719],
            [120.008787, 30.134204],
            [120.007004, 30.130026],
            [120.003819, 30.12659],
            [120.001941, 30.119567],
            [120.000468, 30.116034],
            [120.001822, 30.114357],
            [120.01095, 30.116254],
            [120.016417, 30.115718],
            [120.017725, 30.113189],
            [120.016465, 30.108323],
            [120.019151, 30.10567],
            [120.02324, 30.10633],
            [120.025213, 30.105519],
            [120.030442, 30.098837],
            [120.030846, 30.094768],
            [120.036361, 30.092555],
            [120.041258, 30.093091],
            [120.043635, 30.092156],
            [120.044894, 30.086368],
            [120.049125, 30.086849],
            [120.052953, 30.091661],
            [120.054902, 30.09272],
            [120.059513, 30.092788],
            [120.061748, 30.091853],
            [120.067928, 30.086794],
            [120.076747, 30.080868],
            [120.084615, 30.078269],
            [120.091579, 30.078475],
            [120.09795, 30.079603],
            [120.108955, 30.08062],
            [120.115088, 30.082229],
            [120.118131, 30.083796],
            [120.123812, 30.089461],
            [120.124739, 30.092953],
            [120.130349, 30.099305],
            [120.134818, 30.097669],
            [120.146869, 30.088664],
            [120.150459, 30.091455],
            [120.162011, 30.097985],
            [120.170354, 30.101546],
            [120.177295, 30.102604],
            [120.182168, 30.104818],
            [120.182953, 30.10846],
            [120.181835, 30.111457],
            [120.177723, 30.11712],
            [120.16831, 30.121793],
            [120.160014, 30.12637],
            [120.146132, 30.137172],
            [120.138597, 30.142078],
            [120.130373, 30.151161],
            [120.125999, 30.15946],
            [120.124596, 30.167263],
            [120.12462, 30.177346],
            [120.126664, 30.182827],
            [120.129659, 30.186852],
            [120.134128, 30.190588],
            [120.140166, 30.19284],
            [120.138169, 30.19512],
            [120.1371, 30.1981],
            [120.137551, 30.201012],
            [120.141545, 30.204061],
            [120.141069, 30.206464],
            [120.138431, 30.207947],
            [120.139405, 30.210474],
            [120.145253, 30.209581],
            [120.147368, 30.210268],
            [120.150173, 30.212849],
            [120.160347, 30.227486],
            [120.15923, 30.231578],
            [120.154381, 30.23442],
            [120.154666, 30.241119],
            [120.160442, 30.246843],
            [120.15797, 30.24672],
            [120.159848, 30.249493],
            [120.16251, 30.251565],
            [120.15923, 30.256397],
            [120.156948, 30.258058],
            [120.156472, 30.260295],
            [120.158469, 30.259142],
            [120.153763, 30.275734],
            [120.150934, 30.278506],
            [120.149294, 30.28206],
            [120.146132, 30.286589],
            [120.144112, 30.291144],
            [120.141188, 30.293902],
            [120.135198, 30.292626],
            [120.132512, 30.292791],
            [120.128709, 30.294286],
            [120.118012, 30.29264],
            [120.109241, 30.291995],
            [120.106507, 30.292269],
            [120.105533, 30.300227],
            [120.102062, 30.300117],
            [120.102823, 30.304672],
            [120.102038, 30.312697],
            [120.095597, 30.325481],
            [120.092007, 30.326071],
            [120.088489, 30.330529],
            [120.085779, 30.331187],
            [120.081715, 30.335918],
            [120.082808, 30.338853],
            [120.079742, 30.338606],
            [120.080075, 30.342625],
            [120.0762, 30.345285],
            [120.074655, 30.34774],
            [120.069449, 30.350702],
            [120.067334, 30.355446],
            [120.06517, 30.355309],
            [120.065361, 30.352813],
            [120.063673, 30.352128],
            [120.060868, 30.353348],
            [120.060607, 30.351497],
            [120.053951, 30.351401],
            [120.050195, 30.349865],
            [120.048674, 30.353526],
            [120.046463, 30.353759],
            [120.046511, 30.35221],
            [120.038595, 30.350948],
            [120.032795, 30.351634],
            [120.029444, 30.350016],
            [120.023881, 30.348357],
            [120.025973, 30.34523],
            [120.025545, 30.342474],
            [120.027185, 30.335905],
            [120.026425, 30.333272],
            [120.01763, 30.33238],
            [120.01782, 30.329733],
            [120.021362, 30.329088],
            [120.023572, 30.326743],
            [120.023406, 30.319967],
            [120.023881, 30.316195],
            [120.020554, 30.315674],
            [120.02179, 30.311874],
            [120.026686, 30.310996],
            [120.026116, 30.305948],
            [120.028493, 30.303835],
            [120.030799, 30.299843],
            [120.042089, 30.304096],
            [120.048008, 30.30319],
            [120.051907, 30.299513],
            [120.053784, 30.298772],
            [120.054807, 30.295246],
            [120.052953, 30.293847],
            [120.051621, 30.29054],
            [120.052263, 30.289319],
            [120.056732, 30.2884],
            [120.05281, 30.282897],
            [120.049815, 30.27594],
            [120.049815, 30.274266],
            [120.052382, 30.273237],
            [120.056494, 30.273374],
            [120.057255, 30.268351],
            [120.05773, 30.257289],
            [120.058515, 30.252801],
            [120.055306, 30.251483],
            [120.055234, 30.245388],
            [120.052691, 30.245333],
            [120.052216, 30.243494],
            [120.046178, 30.242725],
            [120.0443, 30.240474],
            [120.044538, 30.238058],
            [120.041162, 30.236122],
            [120.040639, 30.232841],
            [120.038571, 30.233019],
            [120.032153, 30.229697],
            [120.030894, 30.230479],
            [120.025046, 30.228461],
            [120.016845, 30.224823],
            [120.01889, 30.219742],
            [120.020268, 30.217985],
            [120.018367, 30.216447],
            [120.015443, 30.218067],
            [120.013755, 30.2162],
            [120.010356, 30.221184],
            [120.007123, 30.2208],
            [120.009999, 30.215637],
            [120.015704, 30.213426],
            [120.018034, 30.214319],
            [120.017487, 30.211792],
            [120.013351, 30.210254],
            [120.007171, 30.208757],
            [120.006529, 30.205379],
            [120.009263, 30.200202],
            [120.009096, 30.195615],
            [120.003439, 30.191865],
            [120.0013, 30.188006],
            [119.996332, 30.181536]
          ]
        ]
      },
      {
        properties: {
          name: '滨江区',
          center: [120.21062, 30.206615]
        },
        coordinates: [
          [
            [120.221057, 30.23766],
            [120.211287, 30.228722],
            [120.196573, 30.216571],
            [120.182858, 30.207933],
            [120.177628, 30.205626],
            [120.140166, 30.19284],
            [120.134128, 30.190588],
            [120.129659, 30.186852],
            [120.126664, 30.182827],
            [120.12462, 30.177346],
            [120.124596, 30.167263],
            [120.125999, 30.15946],
            [120.130373, 30.151161],
            [120.138597, 30.142078],
            [120.146132, 30.137172],
            [120.152764, 30.142751],
            [120.155902, 30.144332],
            [120.154737, 30.145953],
            [120.159087, 30.148894],
            [120.16232, 30.147382],
            [120.164816, 30.150062],
            [120.168286, 30.148646],
            [120.170473, 30.15112],
            [120.175203, 30.153881],
            [120.178864, 30.149416],
            [120.180338, 30.149814],
            [120.181717, 30.147245],
            [120.184141, 30.145362],
            [120.186661, 30.146599],
            [120.186185, 30.144428],
            [120.19189, 30.147121],
            [120.197167, 30.140759],
            [120.201375, 30.139563],
            [120.204084, 30.141061],
            [120.205273, 30.143026],
            [120.208054, 30.139302],
            [120.208743, 30.137131],
            [120.211572, 30.136375],
            [120.213307, 30.137887],
            [120.214543, 30.136911],
            [120.219464, 30.139948],
            [120.216944, 30.143081],
            [120.219892, 30.150515],
            [120.221651, 30.153758],
            [120.224598, 30.153868],
            [120.223148, 30.156684],
            [120.226167, 30.16016],
            [120.224979, 30.162716],
            [120.220534, 30.162578],
            [120.216849, 30.161314],
            [120.217943, 30.164749],
            [120.219963, 30.16703],
            [120.220557, 30.170519],
            [120.224384, 30.171247],
            [120.222293, 30.173637],
            [120.222055, 30.178885],
            [120.224646, 30.179173],
            [120.224575, 30.181879],
            [120.233488, 30.182044],
            [120.233679, 30.1835],
            [120.236721, 30.182978],
            [120.23684, 30.184585],
            [120.233988, 30.185904],
            [120.234202, 30.188788],
            [120.234463, 30.21355],
            [120.234962, 30.21366],
            [120.235224, 30.228132],
            [120.234439, 30.229793],
            [120.231896, 30.230177],
            [120.226524, 30.232896],
            [120.223957, 30.2363],
            [120.221057, 30.23766]
          ]
        ]
      }
    ]
  }, 2000)
})
</script>
